<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>RU Racing Doorbell</title>
    <style>
        :root {
            --bg: #0b0b0b;
            --red: #e11;
            --red-dark: #a00;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            background: var(--bg);
            color: #fff;
        }

        body {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
        }

        .wrap {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #btn {
            width: min(80vw, 480px);
            height: min(80vw, 480px);
            border-radius: 50%;
            border: none;
            outline: none;
            cursor: pointer;
            background: var(--red);
            color: #fff;
            font-weight: 800;
            letter-spacing: 0.04em;
            font-size: clamp(28px, 9vw, 56px);
            box-shadow: 0 12px 0 var(--red-dark), 0 24px 48px rgba(0, 0, 0, .6);
            transition: transform .06s ease, box-shadow .06s ease, filter .15s ease;
        }

        #btn:active {
            transform: translateY(4px);
            box-shadow: 0 8px 0 var(--red-dark), 0 16px 32px rgba(0, 0, 0, .55);
        }

        #btn:disabled {
            filter: grayscale(0.2) brightness(0.85);
            cursor: not-allowed;
        }

        .status {
            position: fixed;
            bottom: 16px;
            left: 0;
            right: 0;
            text-align: center;
            opacity: 0.9;
            font-size: clamp(12px, 2.5vw, 16px);
        }
    </style>
    <meta charset="utf-8">

    <!-- Favicon (browser tab icon) -->
    <link rel="icon" href="{{ url_for('static', filename='icons/icon-192.png') }}" type="image/png">

    <!-- PWA manifest (used by Android/Chrome for Add to Home Screen) -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.webmanifest') }}">

    <!-- iOS home screen icon (Safari ignores the manifest for icons) -->
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='icons/apple-touch-icon.png') }}">

    <!-- Android status bar color when launched from home screen -->
    <meta name="theme-color" content="#000000">

    <title>RU Racing Button</title>
</head>

<body>
    <div class="wrap">
        <button id="btn" aria-label="Ring the bell">DING DONG</button>
    </div>
    <div class="status" id="status">Ready</div>
    <script>
        const btn = document.getElementById('btn');
        const statusEl = document.getElementById('status');
        async function ring() {
            btn.disabled = true;
            statusEl.textContent = 'Ringing…';
            try {
                const res = await fetch('/ding', { method: 'POST' });
                const data = await res.json().catch(() => ({}));
                if (res.ok && data.ok) {
                    statusEl.textContent = 'Dinged!';
                } else {
                    statusEl.textContent = 'Error — ' + (data.error || res.statusText);
                }
            } catch (e) {
                statusEl.textContent = 'Network error';
            } finally {
                setTimeout(() => { statusEl.textContent = 'Ready'; btn.disabled = false; }, 800);
            }
        }
        btn.addEventListener('click', ring);
        document.addEventListener('keydown', (e) => { if (e.code === 'Space' || e.code === 'Enter') ring(); });
    </script>
</body>

</html>